<app-breadcrumb *ngIf="!loadSave" [data]="contentHeader"></app-breadcrumb>
<!-- <div class="header float-left w-100 mb-2">
  <h2 class="float-left pr-2"><strong>Proposal Detail</strong></h2>
  <div class="breadcrumb-wrapper">
    <ol class="breadcrumb">
      <li><a class="smview" routerLink="/dashboard">Home</a></li>
      <li><a class="smview" routerLink="/proposal-list">Proposal</a></li>
      <li class="active">Proposal Detail</li>
    </ol>
  </div>

</div> -->
<div class="clearfix"></div>

<div class="card mb-4 mt-1 border-0" style="background:none;">
    <div class="card-body p-0">
        <ul class="nav nav-tabs nav-cust" id="myTab" role="tablist">
            <li class="nav-item" *ngFor="let  c of stagelist; let i=index">
                <a *ngIf="c.activeTab==1" class="nav-link active" (click)="tabclick(c.stageid)" data-toggle="tab" href="javascript:void(0);" role="tab" aria-controls="sales" aria-selected="false"><span class="circle">{{c.rowNo1}}</span> {{c.stageName}}</a>
                <a *ngIf="c.activeTab!=1" class="nav-link" (click)="tabclick(c.stageid)" data-toggle="tab" href="javascript:void(0);" role="tab" aria-controls="sales" aria-selected="false"> <span class="circle">{{c.rowNo1}}</span> {{c.stageName}} </a>



            </li>

        </ul>
        <div class="tab-content bg-white p-0" id="myTabContent">
            <div class="tab-pane fade show active p-0" id="operation" role="tabpanel" aria-labelledby="contact-tab">
                <div class="card-body timeline">
                    <div class="owl-carousel step lead-step owl-loaded owl-drag">
                        <div class="owl-stage-outer">
                            <div class="owl-stage" style="transform: translate3d(0px, 0px, 0px); transition: all 0s ease 0s; width:100%;">
                                <div class="owl-item active" style="width:100%; display: flex; flex-wrap: nowrap;">
                                    <li class="step-item" *ngFor="let  c of oplist">
                                        <!--<a href="javascript:void(0);"><span  class="step-no step-green"> <i class="feather-check"></i> </span></a><br>-->
                                        <a href="javascript:void(0);" *ngIf="c.StageOperationStatus == 'InProgress'; else elseCase" (click)="updateStage(c.subStageId)">
                                            <span [ngClass]="{'step-no step-default':true,'step-default' : c.StageOperationStatus == 'NotStarted',' step-green': c.StageOperationStatus =='Completed' ,'step-dark' :c.StageOperationStatus == 'InProgress'}">
                        <i *ngIf="c.StageOperationStatus =='Completed'" class="feather-check"></i>
                        <i *ngIf="c.StageOperationStatus !='Completed'">{{c.RowNo1}}</i>
                        <!--<i [ngClass]="{'step-default' : c.StageOperationStatus == 'NotStarted',' feather-check': c.StageOperationStatus =='Completed' ,'step-dark' :c.StageOperationStatus == 'In-Progress'}">     </i>-->
                      </span>
                                        </a>
                                        <ng-template #elseCase>

                                            <a>
                                                <span [ngClass]="{'step-no step-default':true,'step-default' : c.StageOperationStatus == 'NotStarted',' step-green': c.StageOperationStatus =='Completed' ,'step-dark' :c.StageOperationStatus == 'InProgress'}">
                          <i *ngIf="c.StageOperationStatus =='Completed'" class="feather-check"></i>
                          <i *ngIf="c.StageOperationStatus !='Completed'">{{c.RowNo1}}</i>
                          <!--<i [ngClass]="{'step-default' : c.StageOperationStatus == 'NotStarted',' feather-check': c.StageOperationStatus =='Completed' ,'step-dark' :c.StageOperationStatus == 'In-Progress'}">     </i>-->
                        </span>
                                            </a>

                                        </ng-template>
                                        <br />
                                        <span class="step-name">{{c.subStageName}}</span>
                                        <!--<a >{{c.subStageName}}</a>-->
                                        <span class="step-date"> {{c.dateshow}} {{c.diff}}</span>
                                    </li>
                                </div>

                            </div>
                        </div>
                        <div class="owl-nav disabled">
                            <button type="button" role="presentation" class="owl-prev disabled">
                <span aria-label="Previous">‹</span>
              </button>
                            <button type="button" role="presentation" class="owl-next disabled"><span aria-label="Next">›</span></button>
                        </div>
                        <div class="owl-dots disabled"><button role="button" class="owl-dot active"><span></span></button></div>
                    </div>
                </div>
                <!--<div class="tab_foot border-top">
          <ul>
            <li><b>Work Order:</b> {{workorder}}  &nbsp;&nbsp;| &nbsp;&nbsp;  <b>Work Order Date:</b> {{workorderDate}}</li>
            <li>Status: {{status}}|  Sub-Staus: HOA  | 3 Days</li>
            <li><a href="#" class="btn btn-success text-right">Update Status</a></li>
          </ul>
        </div>-->
            </div>
            <div class="tab-pane fade " id="closed" role="tabpanel" aria-labelledby="home-tab">
                <div class="row">
                    <div class="col-md-3">
                        <div class="p-4">Coming Soon</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="card mb-3 mt-3">
    <div class="card-body">
        <div class="row">
            <div class="col-md-8">
                <div class="border h-100">
                    <div class="detail-heading cust_infobx px-3 py-2">
                        <ul class="d-flex list_spc">
                            <li><i class="fa fa-phone"></i> N/A </li>
                            <li><i class="fa fa-envelope"></i> N/A</li>
                            <!--<li><i class="fa fa-map-marker"></i> {{Address}} </li>-->
                        </ul>
                    </div>

                    <div class="px-3 py-3">
                        <div class="row">

                            <div class="col-md-12">
                                <div class="row">
                                    <div class="col-3 mb-3">Sub Stage Name:</div>
                                    <div class="col-3 mb-3"><b>N/A</b></div>
                                    <div class="col-3 mb-3">Created By:</div>
                                    <div class="col-3 mb-3"><b>N/A</b></div>
                                    <div class="col-3 mb-3">Created on:</div>
                                    <div class="col-3 mb-3"><b>N/A</b></div>
                                    <div class="col-3 mb-3">Location:</div>
                                    <div class="col-3 mb-3"><b>N/A</b></div>
                                </div>
                            </div>

                            <!--<div class="col-md-6 text-center">
                <div class="row">

                </div>
              </div>-->
                            <div class="col-md-12 mt-3 ">
                                <!--<a href="#" class="btn btn-light-blue mr-2 px-4" style="padding-left: 5px;"><i class="fa fa-external-link"></i> View Portal</a>
                <a href="#" class="btn btn-blue mr-2 px-4"><i class="fa fa-phone"></i> Call</a>-->
                                <a href="javascript:void(0);" (click)="showemailpopup()" class="btn btn-orange mr-2 px-4"><i class="fa fa-envelope"></i> Email</a>
                                <!--<a href="#" class="btn btn-thin-blue mr-2 px-4"><i class="fa fa-commenting"></i> SMS</a>
                <a href="#" class="btn btn-green px-4"><i class="fa fa-comments"></i> Chat</a>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <!--<div class="mapbx"><img class="img-fluid" src="assets/images/map-img.jpg" alt="map"></div>-->
            </div>
        </div>
    </div>
</div>


<div class="card mb-3">
    <div class="card-body">
        <div id="accordion" class="panel-group">
            <!--productList Pannel-->
            <div class="panel ">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a href="#panelBody1" class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#accordion" aria-expanded="false"><span> Proposal Line Item</span></a>
                    </h4>
                </div>
                <div id="panelBody1" class="panel-collapse collapse " style="">
                    <a href="javascript:void(0);" class="btn-in-panel" (click)="GetProposalList()" data-dismiss="modal" data-toggle="modal"><i class="feather-plus mr-2"></i> Proposal Line Item</a>
                    <div class="panel-body">
                        <div class="row">
                            <div class="table-responsive">
                                <div class="table table-striped">
                                    <ngx-datatable #table class="bootstrap" [rows]="AssociatedproductpagedData.data" [scrollbarH]="true" [rowHeight]="'40'" [columnMode]="'force'" [headerHeight]="40" [footerHeight]="40" [externalPaging]="true" [externalSorting]="true" [loadingIndicator]="loadSave"
                                        [count]="AssociatedproductpagedData.pager.totalItems" [offset]="AssociatedproductpagedData.pager.currentPage" [limit]="AssociatedproductpagedData.pager.pageSize" (page)='setPageAssociateProduct($event)' (sort)="onSort($event)">



                                        <ngx-datatable-column name="Product Name" sortable="True" prop="ProductName">
                                        </ngx-datatable-column>

                                        <ngx-datatable-column name="Product Family" sortable="True" prop="ProductFamily"></ngx-datatable-column>
                                        <ngx-datatable-column name="Product Code" sortable="True" prop="ProductCode"></ngx-datatable-column>
                                        <ngx-datatable-column name="Purchase Price" sortable="True" prop="PurchasePrice"></ngx-datatable-column>
                                        <ngx-datatable-column name="Sale Price" sortable="True" prop="SalePrice"></ngx-datatable-column>
                                        <ngx-datatable-column name="Discount(%)" sortable="True" prop="Discount"></ngx-datatable-column>
                                        <ngx-datatable-column name="Line Item Discription" sortable="True" prop="LineItemDiscription">
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                {{row.LineItemDiscription | truncate : 50}}
                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-column headerClass="text-center" name="Action" [sortable]="false">
                                            <ng-template let-row="row" ngx-datatable-cell-template>
                                                <div class="text-center">
                                                    <a href="javascript:void(0);" (click)="editProduct(row)" title="Edit"><i class="fa fa-pencil text-success pr-2"></i></a>
                                                    <a (click)="deleteAssociateproduct(row)" class="btn-delete"><i title="Click to delete." class="feather-trash-2 text-danger"></i></a>
                                                </div>

                                            </ng-template>
                                        </ngx-datatable-column>
                                        <ngx-datatable-footer>
                                            <ng-template ngx-datatable-footer-template let-rowCount="rowCount" let-pageSize="pageSize" let-selectedCount="selectedCount" let-currentPage="currentPage" let-offset="offset" let-isVisible="isVisible">
                                                <div class="page-count" style="max-width:170px;">
                                                    Total Records: {{rowCount}}
                                                </div>
                                                <div>
                                                    <div style="color:black; margin-right:10px;" class="page-size-record">
                                                        <span style="text-align:right; width:80px;vertical-align: middle;">
                              <ng-select [searchable]="false" [items]="lstPageSizeAssociateProduct" appendTo="body" [(ngModel)]='pageSizeValue' dropzone="fixed"
                                         [clearable]="false" (change)="onChangeAssociateProduct($event)" draggable="false" [closeOnSelect]="true"
                                         bindLabel="text" bindValue="text"></ng-select>
                            </span>
                                                    </div>
                                                </div>
                                                <datatable-pager [pagerLeftArrowIcon]="'fa feather-chevrons-left'" [pagerRightArrowIcon]="'fa fa-angle-double-right'" [pagerPreviousIcon]="'fa fa-angle-left'" [pagerNextIcon]="'fa feather-chevron-left'" [page]="AssociatedproductpagedData.pager.currentPage+1"
                                                    [size]="pageSizeValue" [count]="AssociatedproductpagedData.pager.totalItems" [hidden]="!((rowCount / pageSize) > 1)" (change)="setPageAssociateProduct($event)">
                                                </datatable-pager>
                                            </ng-template>
                                        </ngx-datatable-footer>
                                    </ngx-datatable>
                                </div>
                            </div>


                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="card mb-3">
    <div class="card-body">
        <div id="accordion1" class="panel-group">
            <!--productList Pannel-->
            <div class="panel " *ngFor="let item of formControlList; let i=index;">
                <div class="panel-heading">
                    <h4 class="panel-title">
                        <a href="#panelBody1{{i}}" class="accordion-toggle collapsed " data-toggle="collapse" data-target="#panelBody1{{i}}"><span> {{item.group_display_name}}</span></a>
                    </h4>
                </div>
                <div id="panelBody1{{i}}" class="collapse " data-parent="#accordion1">
                    <div class="panel-body">
                        <div class="row  mb-2">
                            <ng-container *ngFor="let inner of item.InnerData">
                                <div [ngClass]="{'col-sm-12 col-md-12 float-left': true, 'd-none' : (inner.form_field_visibility == 'NO' && inner.edit_form_field_visibility == 'NO'), 'col-12': inner.layout_type =='single', 'col-md-6': inner.layout_type =='double', 'col-lg-4': inner.layout_type =='triple', 'col-lg-3 col-xl-3':
                             inner.layout_type =='four' }" ngShow="inner.dependent_show_type == true">
                                    <label *ngIf="inner.form_field_visibility == 'YES' || inner.edit_form_field_visibility == 'YES'">{{ inner.display_name}}:<span class="text-danger" [ngClass]="{'text-danger':inner.is_required== true}" *ngIf="inner.is_required==true"></span></label>                                    &nbsp;
                                    <label *ngIf="inner.value!=null"><b>{{inner.value}}</b></label> &nbsp;
                                    <label *ngIf="inner.value==null || inner.value==''"><b>N/A</b></label>
                                </div>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<app-proposallineitempopup #proposalpopup (lineItem)="lineItem()"></app-proposallineitempopup>